<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>DeFi Index API · Документация</title>
  <meta name="description" content="Элегантная статическая документация для DeFi Index API с боковым меню, примерами кода и безопасной песочницей." />
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=JetBrains+Mono:wght@400;600&display=swap" rel="stylesheet">
  <style>
    :root{
      --bg:#F3F2E7;
      --brand:#8E65CE;
      --brand-ink:#5a36a1;
      --ink:#1f1f1f;
      --muted:#5b5b5b;
      --card:#ffffff;
      --code-bg:#e9e7d8;
      --code-border:#d5d2c2;
      --divider:#e2e0d2;
      --shadow:0 10px 30px rgba(0,0,0,.08);
      --radius:14px;
      --sidebar-w: 260px;
      --content-max: 1100px;
    }
    *{box-sizing:border-box}
    html{scroll-behavior:smooth}
    body{
      margin:0;
      font-family:Inter, system-ui, -apple-system, Segoe UI, Roboto, "Helvetica Neue", Arial;
      color:var(--ink);
      background:var(--bg);
      line-height:1.6;
      letter-spacing:.2px;
    }

    .page{
      display:flex;
      align-items:flex-start;
      justify-content:center;
      gap:24px;
      width:100%;
      padding:28px 20px 64px;
    }
    .sidebar{
      position:sticky;
      top:18px;
      width:var(--sidebar-w);
      flex:0 0 var(--sidebar-w);
      align-self:flex-start;
      background:transparent;
    }
    .sidebar .brand{
      display:flex; gap:10px; align-items:center; margin:2px 0 10px;
      color:var(--brand); font-weight:800; text-transform:uppercase; letter-spacing:.14em;
    }
    .sidebar .brand svg{width:22px;height:22px}
    nav.side{
      display:flex; flex-direction:column; gap:8px;
    }
    nav.side a{
      text-decoration:none; color:#2b2b2b; background:#fff;
      padding:10px 14px; border:1px solid var(--divider); border-radius:10px;
      font-weight:700; font-size:14px; transition:.15s ease; box-shadow:var(--shadow);
    }
    nav.side a:hover{background:var(--brand); color:#fff; border-color:var(--brand)}
    nav.side a.active{background:var(--brand); color:#fff; border-color:var(--brand)}

    .content{
      width:min(var(--content-max), calc(100% - var(--sidebar-w) - 48px));
      max-width:var(--content-max);
    }

    h1{font-size:40px; line-height:1.18; margin:.2em 0 .2em}
    .subtitle{color:var(--muted); font-size:18px; margin:.2em 0 18px}
    section{margin-top:34px}
    .card{
      background:var(--card); border:1px solid var(--divider);
      border-radius:var(--radius); box-shadow:var(--shadow);
      padding:22px 22px;
    }
    .kicker{color:var(--brand); font-weight:800; text-transform:uppercase; letter-spacing:.14em; font-size:12px}
    .h2{font-size:28px; font-weight:800; margin:6px 0 12px;}
    .meta{display:flex; gap:14px; flex-wrap:wrap; margin-top:6px}
    .meta .pill{background:rgba(142,101,206,.12); border:1px solid rgba(142,101,206,.25); color:var(--brand-ink);
                padding:6px 10px; border-radius:999px; font-size:12px; font-weight:700}

    .grid-2{display:grid; grid-template-columns:1.2fr .8fr; gap:20px}
    @media (max-width: 1040px){
      .page{padding:20px 14px 56px}
      .sidebar{display:none}
      .content{width:100%}
    }

    .table{width:100%; border-collapse:collapse; margin-top:10px; overflow:hidden; border-radius:10px; border:1px solid var(--divider)}
    .table th, .table td{padding:12px 14px; text-align:left; border-bottom:1px solid var(--divider)}
    .table th{background:#faf8f0; color:#3b3b3b; font-size:13px; text-transform:uppercase; letter-spacing:.08em}
    .muted{color:var(--muted)}
    .footer{margin-top:56px; padding:22px 0 42px; color:var(--muted); border-top:1px solid var(--divider)}

    pre, code{
      font-family: "JetBrains Mono", ui-monospace, SFMono-Regular, Menlo, Consolas, "Liberation Mono", monospace;
      font-size:13.5px;
    }
    pre{
      background:var(--code-bg);
      border:1px solid var(--code-border);
      border-radius:12px; padding:16px 16px; overflow:auto; position:relative;
      box-shadow:inset 0 1px 0 rgba(255,255,255,.4);
    }
    .code-toolbar{
      display:flex; align-items:center; justify-content:space-between; gap:10px;
      margin-bottom:10px
    }
    .tabs{display:flex; gap:8px; flex-wrap:wrap}
    .tab-btn{
      appearance:none; background:#fff; border:1px solid var(--divider); padding:8px 10px;
      border-radius:8px; font-weight:700; font-size:12px; cursor:pointer;
      transition:.15s ease; color:#2b2b2b;
    }
    .tab-btn.active{background:var(--brand); color:#fff; border-color:var(--brand)}
    .copy{
      background:#1f1f1f; color:#fff; border:none; padding:8px 10px; border-radius:8px; font-weight:700; font-size:12px; cursor:pointer;
    }
    .tiny{font-size:12px}

    .readonly{background:#f7f6ed;border:1px dashed var(--divider);padding:10px 12px;border-radius:10px;font-family:Inter;font-size:14px;user-select:all}

    .topnav{
      position:sticky; top:0; z-index:10;
      display:none; gap:8px; flex-wrap:wrap;
      background:linear-gradient(180deg, rgba(243,242,231,.98), rgba(243,242,231,.85));
      padding:10px 6px; margin-bottom:8px; border-bottom:1px solid var(--divider);
      backdrop-filter: blur(6px);
    }
    .topnav a{ text-decoration:none; color:#2b2b2b; background:#fff; padding:8px 12px; border:1px solid var(--divider);
      border-radius:10px; font-weight:700; font-size:13px; transition:.15s ease; }
    .topnav a:hover{ background:var(--brand); color:#fff; border-color:var(--brand) }
    @media (max-width:1040px){ .topnav{display:flex} }
  </style>
</head>
<body>
  <div class="page">
    <aside class="sidebar" aria-label="Навигация по документации">
      <div class="brand">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M12 3l8 4.5v9L12 21l-8-4.5v-9L12 3z"></path>
          <path d="M12 12l8-4.5M12 12v9M12 12L4 7.5"></path>
        </svg>
        <span>DeFi Index API</span>
      </div>
      <nav class="side" id="side-nav">
        <a href="#overview">Описание</a>
        <a href="#request">HTTP запрос</a>
        <a href="#schema">Схема ответа</a>
        <a href="#examples">Примеры</a>
        <a href="#try">Песочница</a>
        <a href="#terms">Правила</a>
      </nav>
    </aside>

    <main class="content">
      <div class="topnav" aria-label="Навигация">
        <a href="#overview">Описание</a>
        <a href="#request">HTTP запрос</a>
        <a href="#schema">Схема ответа</a>
        <a href="#examples">Примеры</a>
        <a href="#try">Песочница</a>
        <a href="#terms">Правила</a>
      </div>

      <header class="card" id="top">
        <h1>Исторические данные индекса DeFi — просто, быстро, красиво</h1>
        <p class="subtitle">Публичный REST эндпоинт с дневными OHLC. Ниже — краткая справка, схемы и рабочие примеры.</p>
        <div class="meta">
          <span class="pill">Base URL: <strong>https://wildboar.space:8001</strong></span>
          <span class="pill">Endpoint: <strong>/api/defi_index</strong></span>
          <span class="pill">Метод: <strong>GET</strong></span>
          <span class="pill">Формат: <strong>application/json</strong></span>
        </div>
      </header>

      <section id="overview" class="grid-2">
        <div class="card">
          <div class="kicker">Обзор</div>
          <div class="h2">Что возвращает API</div>
          <p>Эндпоинт возвращает массив дневных свечей для индекса DeFi. Каждая запись — объект с полями даты и ценами OHLC.</p>
          <div class="meta">
            <span class="pill">История за годы</span>
            <span class="pill">Свечи 1d</span>
            <span class="pill">Без ключей</span>
          </div>
        </div>
        <div class="card">
          <div class="kicker">Быстрая справка</div>
          <table class="table">
            <tr><th>База</th><td><code>https://wildboar.space:8001</code></td></tr>
            <tr><th>Эндпоинт</th><td><code>/api/defi_index</code></td></tr>
            <tr><th>Метод</th><td><code>GET</code></td></tr>
            <tr><th>Аутентификация</th><td>не требуется</td></tr>
            <tr><th>Кодировка</th><td><code>UTF-8</code></td></tr>
            <tr><th>CORS</th><td>зависит от настроек сервера</td></tr>
          </table>
        </div>
      </section>

      <section id="request">
        <div class="card">
          <div class="kicker">HTTP Request</div>
          <div class="h2">GET /api/defi_index</div>
          <pre aria-label="HTTP request example"><code>
GET /api/defi_index HTTP/1.1
Host: wildboar.space:8001
Accept: application/json
          </code></pre>
          <p class="muted tiny">Параметров запроса нет.</p>
        </div>
      </section>

      <section id="schema" class="grid-2">
        <div class="card">
          <div class="kicker">Схема ответа</div>
          <div class="h2">Массив объектов OHLC</div>
          <table class="table">
            <thead><tr><th>Поле</th><th>Тип</th><th>Описание</th></tr></thead>
            <tbody>
              <tr><td><code>time</code></td><td>string (YYYY-MM-DD)</td><td>Дата периода</td></tr>
              <tr><td><code>open</code></td><td>number</td><td>Цена открытия</td></tr>
              <tr><td><code>high</code></td><td>number</td><td>Максимальная цена</td></tr>
              <tr><td><code>low</code></td><td>number</td><td>Минимальная цена</td></tr>
              <tr><td><code>close</code></td><td>number</td><td>Цена закрытия</td></tr>
            </tbody>
          </table>
        </div>
        <div class="card">
          <div class="kicker">Пример ответа</div>
          <pre><code class="language-json">[
  {"time":"2020-08-28","open":1012.0,"high":1189.0,"low":964.1,"close":1018.8},
  {"time":"2020-08-29","open":1017.5,"high":1096.5,"low":1015.0,"close":1056.0}
  // … далее по датам
]</code></pre>
        </div>
      </section>

      <section id="examples">
        <div class="card">
          <div class="kicker">Примеры</div>
          <div class="h2" style="margin-bottom:6px">Готовые сниппеты</div>
          <p class="muted tiny" style="margin-top:0">Выберите язык и скопируйте код.</p>
          <div class="code-toolbar">
            <div class="tabs" role="tablist" aria-label="Языки программирования">
              <button class="tab-btn active" data-target="curl" role="tab" aria-selected="true">curl</button>
              <button class="tab-btn" data-target="python" role="tab" aria-selected="false">Python</button>
              <button class="tab-btn" data-target="js" role="tab" aria-selected="false">JavaScript</button>
            </div>
            <button class="copy" data-copy="#code-curl">Копировать</button>
          </div>

          <div id="panes">
            <div class="pane" id="pane-curl" role="tabpanel">
              <pre><code id="code-curl">curl -sS https://wildboar.space:8001/api/defi_index | jq .</code></pre>
            </div>

            <div class="pane" id="pane-python" role="tabpanel" hidden>
              <pre><code id="code-python">import requests, json

URL="https://wildboar.space:8001/api/defi_index"

r=requests.get(URL,timeout=5,verify=False)

print(json.dumps(r.json(),indent=2,ensure_ascii=False)) if r.ok else print("Error:",r.status_code,r.text)</code></pre>
            </div>

            <div class="pane" id="pane-js" role="tabpanel" hidden>
              <pre><code id="code-js">// Вариант 1: браузерный fetch
fetch("https://wildboar.space:8001/api/defi_index")
  .then(r => r.json())
  .then(data => console.log(data))
  .catch(console.error);

// Вариант 2: Node.js (ESM)
import fetch from "node-fetch";
const res = await fetch("https://wildboar.space:8001/api/defi_index");
if (!res.ok) throw new Error(res.status + " " + res.statusText);
const data = await res.json();
console.log(data);</code></pre>
            </div>
          </div>
        </div>
      </section>

      <section id="try">
        <div class="card">
          <div class="kicker">Песочница</div>
          <div class="h2">Попробовать запрос прямо на странице</div>
          <p class="muted tiny">URL зафиксирован, чтобы предотвратить произвольные запросы. Отображаем только последние записи с настраиваемым объёмом и шагом.</p>
          <div style="display:grid; grid-template-columns:1fr .6fr .6fr .5fr; gap:10px; align-items:center; margin:10px 0 6px">
            <div class="readonly" id="readonly-url" aria-readonly="true">https://wildboar.space:8001/api/defi_index</div>
            <select id="limit" style="padding:10px 12px; border-radius:10px; border:1px solid var(--divider); background:#fff">
              <option value="10">Показать: 10</option>
              <option value="30" selected>Показать: 30</option>
              <option value="90">Показать: 90</option>
              <option value="365">Показать: 365</option>
            </select>
            <select id="step" style="padding:10px 12px; border-radius:10px; border:1px solid var(--divider); background:#fff">
              <option value="1" selected>Шаг: 1 день</option>
              <option value="7">Шаг: 7 дней</option>
              <option value="30">Шаг: 30 дней</option>
            </select>
            <button id="run" class="copy" style="background:#8E65CE">Обновить</button>
          </div>
          <div class="tiny muted" id="stats" style="margin:6px 2px 10px"></div>
          <pre id="out" aria-live="polite" style="min-height:140px"><code>// Результат будет здесь…</code></pre>
        </div>
      </section>

      <section id="terms">
        <div class="card">
          <div class="kicker">Правила использования</div>
          <div class="h2">Пожалуйста, соблюдайте условия</div>
          <ul>
            <li>Вы не имеете права использовать наши данные для того, чтобы выдавать себя за нас или создавать услуги, которые могут быть перепутаны с нашими предложениями.</li>
            <li>Вы должны надлежащим образом подтвердить источник данных и соответствующим образом указать на него.</li>
            <li>Коммерческое использование разрешено при условии указания авторства рядом с отображением данных. Свяжитесь с нами при возникновении вопросов.</li>
            <li>Это относится ко всем нашим данным, а не только к API.</li>
          </ul>
        </div>
      </section>

    </main>
  </div>

  <script>
    const links = Array.from(document.querySelectorAll('#side-nav a'));
    const observer = new IntersectionObserver((entries) => {
      entries.forEach(entry => {
        const id = entry.target.getAttribute('id');
        const link = links.find(a => a.getAttribute('href') === '#' + id);
        if (link) {
          if (entry.isIntersecting) {
            links.forEach(l => l.classList.remove('active'));
            link.classList.add('active');
          }
        }
      });
    }, { rootMargin: '-45% 0px -50% 0px', threshold: 0.01 });

    document.querySelectorAll('section[id], header#top').forEach(sec => observer.observe(sec));

    const tabs = document.querySelectorAll('.tab-btn');
    const panes = {
      curl: document.getElementById('pane-curl'),
      python: document.getElementById('pane-python'),
      js: document.getElementById('pane-js')
    };
    const copyBtn = document.querySelector('.copy[data-copy], .copy:not([id="run"])');
    const copyTargets = {
      curl: document.getElementById('code-curl'),
      python: document.getElementById('code-python'),
      js: document.getElementById('code-js')
    };
    let current = 'curl';
    tabs.forEach(btn => {
      btn.addEventListener('click', () => {
        tabs.forEach(b => b.classList.remove('active'));
        btn.classList.add('active');
        const target = btn.getAttribute('data-target');
        Object.keys(panes).forEach(k => panes[k].hidden = (k !== target));
        current = target;
      });
    });
    if (copyBtn) {
      copyBtn.addEventListener('click', async () => {
        const node = copyTargets[current];
        try{
          await navigator.clipboard.writeText(node.innerText);
          copyBtn.textContent = 'Скопировано ✓';
          setTimeout(() => copyBtn.textContent = 'Копировать', 1600);
        }catch(e){
          copyBtn.textContent = 'Ошибка';
          setTimeout(() => copyBtn.textContent = 'Копировать', 1600);
        }
      });
    }

    const API_URL='https://wildboar.space:8001/api/defi_index';
    const run = document.getElementById('run');
    const limit = document.getElementById('limit');
    const step = document.getElementById('step');
    const out = document.getElementById('out').querySelector('code');
    const stats = document.getElementById('stats');

    async function fetchAndRender(){
      out.textContent = '// Выполняется запрос…';
      stats.textContent = '';
      try{
        const r = await fetch(API_URL);
        const text = await r.text();
        const raw = JSON.parse(text);
        const total = Array.isArray(raw) ? raw.length : 0;

        const N = parseInt(limit.value, 10);
        const S = parseInt(step.value, 10);
        const tail = raw.slice(-N);
        const sampled = tail.filter((_, i) => i % S === 0);

        if(sampled.length){
          const first = sampled[0].time;
          const last = sampled[sampled.length-1].time;
          stats.innerHTML = `Всего в ответе: <b>${total}</b> · Период в выборке: <b>${first}</b> → <b>${last}</b> · Показано: <b>${sampled.length}</b>`;
        }

        out.textContent = JSON.stringify(sampled, null, 2);
      }catch(err){
        out.textContent = 'Ошибка: ' + (err.message || err);
      }
    }
    run.addEventListener('click', fetchAndRender);
    fetchAndRender();
  </script>
</body>
</html>
